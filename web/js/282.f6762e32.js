"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[282],{1208:(e,a,o)=>{o.d(a,{vk:()=>n,He:()=>r,Tb:()=>s,Be:()=>c});var t=o(1768);const n={cId:0,mId:0};function r(e,a){return new Promise(((o,n)=>{const r={type:"LOGIN_REQUEST",username:e,password:a};t.api.post("/mappa/login",r).then((e=>{o(e.data)})).catch((e=>{n(e)}))}))}function s(){return new Promise(((e,a)=>{t.api.get("/hc").then((a=>e(a.data))).catch((e=>{a(e)}))}))}function c(e){try{const a=atob(e),o=JSON.parse(a);if(!o.cId||!o.mId)throw new Error("Invalid context data");return{cId:o.cId,mId:o.mId}}catch(a){return console.error("ParseContent",a),n}}},9282:(e,a,o)=>{o.r(a),o.d(a,{default:()=>C});var t=o(3673);const n={class:"column"},r=(0,t.Wm)("div",{class:"row"},[(0,t.Wm)("h5",{class:"text-h5 text-white q-my-md"},"Autenticação mAPPa")],-1),s={class:"row"},c=(0,t.Wm)("p",{class:"text-grey-16"},[(0,t.Uk)(" Sua senha não será armazenada."),(0,t.Wm)("br"),(0,t.Uk)("Esta autenticação é usada para se obter acesso aos dados do mAPPa. ")],-1),l=(0,t.Wm)("div",{class:"text-h6"},"Chave de autorização",-1),i=(0,t.Wm)("p",{class:"text-grey-16"},[(0,t.Uk)(" Esta chave será utilizada para autorização no grupo da sua seção no Telegram."),(0,t.Wm)("br"),(0,t.Uk)(" Copie e cole no grupo para que o nosso robô faça a conexão corretamente. ")],-1);function u(e,a,o,u,d,p){const m=(0,t.up)("q-input"),h=(0,t.up)("q-form"),f=(0,t.up)("q-card-section"),w=(0,t.up)("q-btn"),g=(0,t.up)("q-card-actions"),y=(0,t.up)("q-card"),q=(0,t.up)("q-separator"),v=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(v,{class:"window-height window-width row justify-center items-center"},{default:(0,t.w5)((()=>[(0,t.Wm)("div",n,[r,(0,t.Wm)("div",s,[e.authKey?((0,t.wg)(),(0,t.j4)(y,{key:1,square:"",bordered:"",class:"q-pa-lg shadow-1"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,null,{default:(0,t.w5)((()=>[l])),_:1}),(0,t.Wm)(q,{inset:""}),(0,t.Wm)(f,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{square:"",filled:"",clearable:"",modelValue:e.authKey,"onUpdate:modelValue":a[3]||(a[3]=a=>e.authKey=a),type:"text",label:"Chave",readonly:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(g,{class:"q-px-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{unelevated:"",color:"positive",size:"lg",class:"full-width",label:"Copiar",onClick:e.clickCopy,icon:"content_copy"},null,8,["onClick"])])),_:1}),(0,t.Wm)(f,{class:"text-center q-pa-none"},{default:(0,t.w5)((()=>[i])),_:1})])),_:1})):((0,t.wg)(),(0,t.j4)(y,{key:0,square:"",bordered:"",class:"q-pa-lg shadow-1"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,null,{default:(0,t.w5)((()=>[(0,t.Wm)(h,{class:"q-gutter-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{square:"",filled:"",clearable:"",modelValue:e.username,"onUpdate:modelValue":a[1]||(a[1]=a=>e.username=a),type:"text",label:"Usuário mAPPa"},null,8,["modelValue"]),(0,t.Wm)(m,{square:"",filled:"",clearable:"",modelValue:e.password,"onUpdate:modelValue":a[2]||(a[2]=a=>e.password=a),type:"password",label:"Senha"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(g,{class:"q-px-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{unelevated:"",color:"positive",size:"lg",class:"full-width",label:"Login",onClick:e.clickLogin},null,8,["onClick"])])),_:1}),(0,t.Wm)(f,{class:"text-center q-pa-none"},{default:(0,t.w5)((()=>[c])),_:1})])),_:1}))])])])),_:1})}var d=o(8825),p=o(1208),m=function(e,a,o,t){function n(e){return e instanceof o?e:new o((function(a){a(e)}))}return new(o||(o=Promise))((function(o,r){function s(e){try{l(t.next(e))}catch(a){r(a)}}function c(e){try{l(t["throw"](e))}catch(a){r(a)}}function l(e){e.done?o(e.value):n(e.value).then(s,c)}l((t=t.apply(e,a||[])).next())}))};const h=(0,t.aZ)({name:"MappaAuth",components:{},data(){return{username:"",password:"",authKey:"",context:p.vk,clipboardEnabled:!1,q:(0,d.Z)()}},mounted(){this.context=(0,p.Be)(this.$route.params.context)},methods:{clickCopy(){navigator.clipboard.writeText(this.authKey).then((()=>{this.q.notify({caption:"Área de transferência",message:"Chave foi copiada com sucesso. Você pode colá-la no grupo do telegram para continuar o setup.",icon:"check_circle",color:"success"})}),(()=>{this.q.notify({caption:"Área de transferência",message:"Erro na cópia para área de transferência. Faça o processo manualmente.",icon:"warning",color:"negative"})}))},clickLogin(){return m(this,void 0,void 0,(function*(){if(this.username&&this.password)try{this.q.notify({caption:"Conectando",message:"Login no proxy mAPPa",icon:"link",group:!1,color:"primary"});let e=yield(0,p.He)(this.username,this.password);if(!e)return void this.q.notify({caption:"Erro",message:"Falha na conexão com o proxy mAPPa!",icon:"warning",color:"negative"});let a=JSON.stringify(e);this.authKey=`/auth ${btoa(a)}`}catch(e){console.error("Login error:",e),this.q.notify({caption:"Erro",message:e.message,icon:"danger",group:!1})}else this.q.notify({caption:"Erro",message:"Informe usuário e senha para continuar!",icon:"warning",color:"negative"})}))}}});var f=o(4379),w=o(151),g=o(5589),y=o(5269),q=o(1206),v=o(9367),b=o(6114),W=o(5869),k=o(7518),x=o.n(k);h.render=u;const C=h;x()(h,"components",{QPage:f.Z,QCard:w.Z,QCardSection:g.Z,QForm:y.Z,QInput:q.Z,QCardActions:v.Z,QBtn:b.Z,QSeparator:W.Z})}}]);